version: 1
default_environment: dev
project_id: meltanolabs-evidence-ext
plugins:
  utilities:
    - name: evidence
      namespace: evidence
      # pip_url: git+https://github.com/meltanolabs/evidence-ext.git@main
      pip_url: -e .
      executable: evidence_extension
      commands:
        describe:
          executable: evidence_extension
          args: describe
        initialize:
          executable: evidence_extension
          args: initialize
        invoke:
          executable: evidence_extension
          args: invoke
      settings:
        - name: home_dir
          label: Evidence Home Dir
          value: $MELTANO_PROJECT_ROOT/analyze/evidence
          env: EVIDENCE_HOME
          description: |
            The directory where Evidence will store its project, configuration, logs, and other files.
        - name: settings.database
          env: DATABASE
        # duckdb
        - name: settings.duckdb.filename
          env: DUCKDB_FILENAME
        # sqlite
        - name: settings.sqlite.filename
          env: SQLITE_FILENAME
        # bigquery
        - name: settings.bigquery.client_email
          env: BIGQUERY_CLIENT_EMAIL
        - name: settings.bigquery.private_key
          env: BIGQUERY_PRIVATE_KEY
        # mysql
        - name: settings.mysql.user
          env: MYSQL_USER
        - name: settings.mysql.host
          env: MYSQL_HOST
        - name: settings.mysql.database
          env: MYSQL_DATABASE
        - name: settings.mysql.password
          env: MYSQL_PASSWORD
        - name: settings.mysql.port
          env: MYSQL_PORT
        - name: settings.mysql.ssl
          env: MYSQL_SSL
        - name: settings.mysql.socket_path
          env: MYSQL_SOCKETPATH
        # postgres / redshift
        - name: settings.postgres.user
          env: POSTGRES_USER
        - name: settings.postgres.host
          env: POSTGRES_HOST
        - name: settings.postgres.database
          env: POSTGRES_DATABASE
        - name: settings.postgres.password
          env: POSTGRES_PASSWORD
        - name: settings.postgres.port
          env: POSTGRES_PORT
        - name: settings.postgres.ssl
          env: POSTGRES_SSL
        - name: settings.postgres.connection_string
          env: POSTGRES_CONNECTIONSTRING
        # snowflake
        - name: settings.snowflake.account
          env: SNOWFLAKE_ACCOUNT
        - name: settings.snowflake.username
          env: SNOWFLAKE_USERNAME
        - name: settings.snowflake.password
          env: SNOWFLAKE_PASSWORD
        - name: settings.snowflake.database
          env: SNOWFLAKE_DATABASE
        - name: settings.snowflake.warehouse
          env: SNOWFLAKE_WAREHOUSE
      settings_group_validation:
        - - home
        - - home
          - settings.database
      config:
        home_dir: $MELTANO_PROJECT_ROOT/sample/
        settings.database: duckdb
        settings.duckdb.filename: needful_things.duckdb
environments:
  - name: dev
  - name: staging
  - name: prod
