version: 1
default_environment: dev
project_id: meltanolabs-evidence-ext
plugins:
  utilities:
    - name: evidence
      namespace: evidence
      # pip_url: git+https://github.com/meltanolabs/evidence-ext.git@main
      pip_url: -e .
      executable: evidence_extension
      commands:
        describe:
          executable: evidence_extension
          args: describe
        initialize:
          executable: evidence_extension
          args: initialize
        invoke:
          executable: evidence_extension
          args: invoke
      settings:
        - name: home_dir
          label: Evidence Home Dir
          value: $MELTANO_PROJECT_ROOT/analyze/evidence
          env: EVIDENCE_HOME
          description: |
            The directory where Evidence will store its project, configuration, logs, and other files.
        - name: settings.database
          env: EVIDENCE_DATABASE
        # duckdb & sqlite
        - name: settings.credentials.filename
          env: EVIDENCE_CREDENTIALS_FILENAME
        - name: settings.credentials.gitignore_duckdb
          env: EVIDENCE_CREDENTIALS_GITIGNORE_DUCKDB
        # bigquery
        - name: settings.credentials.client_email
          env: EVIDENCE_CREDENTIALS_CLIENT_EMAIL
        - name: settings.credentials.private_key
          env: EVIDENCE_CREDENTIALS_PRIVATE_KEY
        #
      settings_group_validation:
        - - home
        # duckdb & sqlite
        - - home
          - settings.database
          - settings.credentials.filename
        # bigquery
        - - home
          - settings.database
          - settings.credentials.client_email
          - settings.credentials.private_key
        # mysql
        - - home
          - settings.database
      config:
        home_dir: $MELTANO_PROJECT_ROOT/sample/
        settings.database: duckdb
        settings.credentials.filename: needful_things.duckdb
        settings.credentials.gitignore_duckdb: null
environments:
  - name: dev
  - name: staging
  - name: prod
